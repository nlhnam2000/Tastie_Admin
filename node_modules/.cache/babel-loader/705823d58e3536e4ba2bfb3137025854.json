{"ast":null,"code":"var _jsxFileName = \"/Users/hoangnam/4thYear/FinalProject/Tastie_AdminDashboard/src/views/utilities/EcouponList.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { styled } from '@mui/material/styles';\nimport { Card, Dialog, DialogActions, DialogContentText, DialogTitle, DialogContent, Button, Modal, Box, Typography } from '@mui/material';\nimport { DataGrid } from '@mui/x-data-grid'; // project imports\n\nimport MainCard from 'ui-component/cards/MainCard';\nimport SecondaryAction from 'ui-component/cards/CardSecondaryAction';\nimport { ecouponColumns, providerByEcouponColumns } from 'assets/columns/gridData';\nimport { HOST_NAME } from 'config';\nimport { CONNECT_SOCKET, DISCONNECT_SOCKET } from 'store/actions'; // assets\n\nimport LinkIcon from '@mui/icons-material/Link'; // libraries\n\nimport axios from 'axios';\nimport { useDispatch, useSelector } from 'react-redux'; // styles\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst IFrameWrapper = styled('iframe')(_ref => {\n  let {\n    theme\n  } = _ref;\n  return {\n    height: 'calc(100vh - 210px)',\n    border: '1px solid',\n    borderColor: theme.palette.primary.light\n  };\n}); // =============================|| TABLER ICONS ||============================= //\n\nconst EcouponList = () => {\n  _s();\n\n  const [rows, setRows] = useState([]);\n  const [openModal, setOpenModal] = useState(false);\n  const [formData, setFormData] = useState({});\n  const [providerList, setProviderList] = useState([]);\n  const [openProviderList, setOpenProviderList] = useState(false);\n  const style = {\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    transform: 'translate(-50%, -50%)',\n    width: '100vh',\n    bgcolor: 'background.paper',\n    border: '2px solid #000',\n    boxShadow: 24,\n    p: 4,\n    maxHeight: '80vh',\n    'overflow-y': 'scroll'\n  };\n\n  const formatDate = date => {\n    const d = new Date(date);\n    let month = (d.getMonth() + 1).toString();\n    let day = d.getDate().toString();\n    const year = d.getFullYear();\n    if (month.length < 2) month = `0${month}`;\n    if (day.length < 2) day = `0${day}`;\n    return [year, month, day].join('-'); // 2022-05-04\n  };\n\n  const openProviderListByEcoupon = async ecoupon_id => {\n    try {\n      const res = await axios.post(`http://${HOST_NAME}:3007/v1/api/tastie/home/get-list-provider-by-ecoupon`, {\n        ecoupon_id: 1,\n        longitude: '106.7002387',\n        latitude: '10.7652217',\n        limit: 5,\n        offset: 1\n      });\n    } catch (error) {}\n  };\n\n  const handleClose = () => {\n    setOpenProviderList(false);\n  }; // const socket = io(`http://${HOST_NAME}:3015`);\n\n\n  const GetAllEcoupon = async (offset, limit) => {\n    try {\n      const config = {\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      };\n      const res = await axios.post(`http://${HOST_NAME}:3010/v1/api/tastie/admin/get-all-ecoupon`, {\n        limit,\n        offset\n      }, config);\n\n      if (res.data.status) {\n        const clone = [...res.data.response];\n        setRows(clone.map(item => ({ ...item,\n          // update_at: new Date(item.update_at).toLocaleString('vi-VI'),\n          // start_date: new Date(item.start_date).toLocaleString('vi-VI'),\n          // expire_date: new Date(item.expire_date).toLocaleString('vi-VI')\n          update_at: formatDate(item.update_at),\n          start_date: formatDate(item.start_date),\n          expire_date: formatDate(item.expire_date)\n        })));\n      }\n    } catch (error) {\n      console.error('Cannot get all ecoupons', error);\n    }\n  };\n\n  const handleUpdateRow = async formData => {\n    try {\n      const res = await axios.post(`http://${HOST_NAME}:3010/v1/api/tastie/admin/update-ecoupon`, formData);\n\n      if (res.data.status) {\n        await GetAllEcoupon(1, 50);\n      }\n    } catch (error) {\n      console.error('Cannot update ecoupon', error);\n    } finally {\n      setOpenModal(false);\n    }\n  };\n\n  useEffect(() => {\n    // socket.emit('admin', 'hello from admin');\n    GetAllEcoupon(1, 50);\n  }, []);\n  useEffect(() => {\n    console.log(formData);\n  }, [formData]);\n  return /*#__PURE__*/_jsxDEV(MainCard, {\n    title: \"Ecoupon List\" // secondary={\n    //     <Button variant=\"contained\" onClick={() => addCoupon()}>\n    //         SOCKET\n    //     </Button>\n    // }\n    ,\n    children: [/*#__PURE__*/_jsxDEV(DataGrid, {\n      rows: rows,\n      columns: ecouponColumns,\n      pageSize: 50,\n      checkboxSelection: true,\n      disableSelectionOnClick: true,\n      getRowId: row => row.ecoupon_id,\n      sx: {\n        width: '100%',\n        height: '70vh'\n      } // onPageChange={(page) => alert(page)}\n      ,\n      onCellEditCommit: event => {\n        const rowEdited = rows.find(row => row.ecoupon_id === event.id);\n        setFormData(prev => ({ ...prev,\n          ...rowEdited,\n          start_date: formatDate(rowEdited.start_date),\n          expire_date: formatDate(rowEdited.expire_date),\n          update_at: formatDate(rowEdited.update_at),\n          [event.field]: event.value\n        }));\n        setOpenModal(true); // const formData = {\n        //     ...rowEdited,\n        //     [event.field]: event.value\n        // };\n        // console.log(formData);\n        // handleUpdateRow(formData);\n      },\n      onRowClick: (params, event, details) => {\n        console.log(params);\n        setOpenProviderList(true);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(Dialog, {\n        open: openModal,\n        onClose: () => setOpenModal(false),\n        \"aria-labelledby\": \"alert-dialog-title\",\n        \"aria-describedby\": \"alert-dialog-description\",\n        children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n          id: \"alert-dialog-title\",\n          children: \"Are you sure to apply the changes ?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n          children: /*#__PURE__*/_jsxDEV(DialogContentText, {\n            id: \"alert-dialog-description\",\n            children: \"This action will change the original record. Would you like to apply change ?\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            onClick: () => setOpenModal(false),\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 196,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            onClick: () => handleUpdateRow(formData),\n            autoFocus: true,\n            children: \"Apply\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      open: openProviderList,\n      onClose: handleClose,\n      \"aria-labelledby\": \"modal-modal-title\",\n      \"aria-describedby\": \"modal-modal-description\",\n      children: /*#__PURE__*/_jsxDEV(Box, {\n        sx: style,\n        children: [/*#__PURE__*/_jsxDEV(Typography, {\n          id: \"modal-modal-title\",\n          variant: \"h6\",\n          component: \"h2\",\n          children: \"Text in a modal\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Typography, {\n          id: \"modal-modal-description\",\n          sx: {\n            mt: 2\n          },\n          children: \"Lorem ipsum, dolor sit amet consectetur adipisicing elit. Beatae nesciunt cupiditate praesentium neque odit, dicta quas delectus assumenda alias ab numquam! Quisquam facere odio veniam quos, pariatur sint quia doloribus magni, aperiam repudiandae ad reiciendis a placeat totam quidem porro consequuntur voluptate, hic vitae neque fugit eius. Dolorum, quibusdam sed consectetur iusto, quae tenetur ipsa et molestiae saepe ipsam cum enim nesciunt eligendi, eveniet aut. Iure quasi numquam at saepe. Eos eveniet quas numquam molestias quos voluptates, provident nam cumque unde porro aliquam sint doloribus harum? Nesciunt quam nihil praesentium laborum, ad placeat inventore porro voluptate? Expedita cumque voluptatibus nobis? Earum in cupiditate ea soluta excepturi modi dolore necessitatibus sed voluptates tempore quaerat, a minima, beatae laudantium delectus accusantium voluptas aliquam eos corrupti? Molestias excepturi libero esse asperiores, totam voluptates hic ullam doloribus iusto voluptatem molestiae quo saepe maxime nam inventore amet alias iure animi! Ratione laudantium iusto cum voluptatibus quos a minus sapiente architecto voluptas ipsum? Officiis voluptatem dolores nesciunt quidem, illum maxime reprehenderit aliquid veritatis incidunt nobis aut! Unde commodi aperiam doloremque delectus, sapiente quisquam reprehenderit dolorem explicabo sequi qui ipsam nam earum dolores maxime eos? Veniam mollitia alias voluptate dolores dolorem, qui quibusdam rem aspernatur impedit vero, quae quidem sequi? Enim recusandae aliquam repudiandae tempora omnis incidunt doloremque perspiciatis voluptates autem iusto voluptas itaque consequatur quisquam eligendi iure, ut numquam minima possimus deserunt dolore? Quis, eius, omnis recusandae cumque numquam velit blanditiis deleniti earum optio quisquam quo hic, et exercitationem. Dolorem nemo aut molestiae porro corrupti, saepe sequi eaque fugit animi iste sunt odit ex. Ex hic illum officiis eaque quam accusantium quos beatae, voluptate aut dolores expedita recusandae ab eligendi doloremque, reiciendis ducimus amet, modi ad saepe ipsam! Quisquam unde nihil doloremque! Architecto aut molestiae repudiandae, tempore iste qui sequi itaque ea sit. Libero excepturi amet, fugiat laudantium quas quis at in consequatur corporis optio modi recusandae nihil ab exercitationem nostrum iusto alias dignissimos magnam, quam tenetur officia facilis quia, praesentium ducimus! Enim, natus? Vitae aliquid sapiente necessitatibus ullam cumque deleniti possimus ad optio pariatur, facere in ex deserunt quidem, rerum, ea quas. Earum dolorem ex ab reiciendis, officia culpa maiores, eveniet nemo sapiente fuga necessitatibus aliquam. Nobis adipisci voluptas necessitatibus corporis repudiandae ad sint. Obcaecati esse voluptatem cumque sit delectus hic quibusdam dolor eveniet nulla totam? Tenetur consectetur minima libero laborum quod ab, consequuntur rem magni nesciunt nisi tempore facere distinctio quis, voluptates esse. Ea veritatis labore ipsa sapiente sequi rem ipsam veniam minima dignissimos inventore quaerat recusandae consequatur, quam iure. Labore modi quod molestias mollitia quo nesciunt inventore iusto dolor nisi dolore ipsa, dicta in similique fugit odio at error, corrupti nulla pariatur ut distinctio eaque, voluptatum facilis? Qui facere expedita temporibus pariatur consequuntur numquam odio distinctio fugit, impedit tempora ullam ipsum, commodi repellat quis cupiditate omnis. Iure harum quibusdam non magnam perspiciatis error similique quaerat velit, esse, in quidem sit maxime quos eaque nobis repudiandae dignissimos nisi placeat sed voluptas adipisci. Quibusdam eveniet culpa itaque eum impedit error ullam amet eaque ipsam beatae!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 139,\n    columnNumber: 9\n  }, this);\n};\n\n_s(EcouponList, \"Iuo6enTWQZMTGABsyVlXgIZ6u0g=\");\n\n_c = EcouponList;\nexport default EcouponList;\n\nvar _c;\n\n$RefreshReg$(_c, \"EcouponList\");","map":{"version":3,"sources":["/Users/hoangnam/4thYear/FinalProject/Tastie_AdminDashboard/src/views/utilities/EcouponList.js"],"names":["React","useEffect","useState","styled","Card","Dialog","DialogActions","DialogContentText","DialogTitle","DialogContent","Button","Modal","Box","Typography","DataGrid","MainCard","SecondaryAction","ecouponColumns","providerByEcouponColumns","HOST_NAME","CONNECT_SOCKET","DISCONNECT_SOCKET","LinkIcon","axios","useDispatch","useSelector","IFrameWrapper","theme","height","border","borderColor","palette","primary","light","EcouponList","rows","setRows","openModal","setOpenModal","formData","setFormData","providerList","setProviderList","openProviderList","setOpenProviderList","style","position","top","left","transform","width","bgcolor","boxShadow","p","maxHeight","formatDate","date","d","Date","month","getMonth","toString","day","getDate","year","getFullYear","length","join","openProviderListByEcoupon","ecoupon_id","res","post","longitude","latitude","limit","offset","error","handleClose","GetAllEcoupon","config","headers","data","status","clone","response","map","item","update_at","start_date","expire_date","console","handleUpdateRow","log","row","event","rowEdited","find","id","prev","field","value","params","details","mt"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\n\r\nimport { styled } from '@mui/material/styles';\r\nimport { Card, Dialog, DialogActions, DialogContentText, DialogTitle, DialogContent, Button, Modal, Box, Typography } from '@mui/material';\r\nimport { DataGrid } from '@mui/x-data-grid';\r\n\r\n// project imports\r\nimport MainCard from 'ui-component/cards/MainCard';\r\nimport SecondaryAction from 'ui-component/cards/CardSecondaryAction';\r\nimport { ecouponColumns, providerByEcouponColumns } from 'assets/columns/gridData';\r\nimport { HOST_NAME } from 'config';\r\nimport { CONNECT_SOCKET, DISCONNECT_SOCKET } from 'store/actions';\r\n\r\n// assets\r\nimport LinkIcon from '@mui/icons-material/Link';\r\n\r\n// libraries\r\nimport axios from 'axios';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\n\r\n// styles\r\nconst IFrameWrapper = styled('iframe')(({ theme }) => ({\r\n    height: 'calc(100vh - 210px)',\r\n    border: '1px solid',\r\n    borderColor: theme.palette.primary.light\r\n}));\r\n\r\n// =============================|| TABLER ICONS ||============================= //\r\n\r\nconst EcouponList = () => {\r\n    const [rows, setRows] = useState([]);\r\n    const [openModal, setOpenModal] = useState(false);\r\n    const [formData, setFormData] = useState({});\r\n    const [providerList, setProviderList] = useState([]);\r\n    const [openProviderList, setOpenProviderList] = useState(false);\r\n\r\n    const style = {\r\n        position: 'absolute',\r\n        top: '50%',\r\n        left: '50%',\r\n        transform: 'translate(-50%, -50%)',\r\n        width: '100vh',\r\n        bgcolor: 'background.paper',\r\n        border: '2px solid #000',\r\n        boxShadow: 24,\r\n        p: 4,\r\n        maxHeight: '80vh',\r\n        'overflow-y': 'scroll'\r\n    };\r\n\r\n    const formatDate = (date) => {\r\n        const d = new Date(date);\r\n        let month = (d.getMonth() + 1).toString();\r\n        let day = d.getDate().toString();\r\n        const year = d.getFullYear();\r\n\r\n        if (month.length < 2) month = `0${month}`;\r\n        if (day.length < 2) day = `0${day}`;\r\n\r\n        return [year, month, day].join('-'); // 2022-05-04\r\n    };\r\n\r\n    const openProviderListByEcoupon = async (ecoupon_id) => {\r\n        try {\r\n            const res = await axios.post(`http://${HOST_NAME}:3007/v1/api/tastie/home/get-list-provider-by-ecoupon`, {\r\n                ecoupon_id: 1,\r\n                longitude: '106.7002387',\r\n                latitude: '10.7652217',\r\n                limit: 5,\r\n                offset: 1\r\n            });\r\n        } catch (error) {}\r\n    };\r\n\r\n    const handleClose = () => {\r\n        setOpenProviderList(false);\r\n    };\r\n\r\n    // const socket = io(`http://${HOST_NAME}:3015`);\r\n\r\n    const GetAllEcoupon = async (offset, limit) => {\r\n        try {\r\n            const config = {\r\n                headers: {\r\n                    'Content-Type': 'application/json'\r\n                }\r\n            };\r\n            const res = await axios.post(\r\n                `http://${HOST_NAME}:3010/v1/api/tastie/admin/get-all-ecoupon`,\r\n                {\r\n                    limit,\r\n                    offset\r\n                },\r\n                config\r\n            );\r\n\r\n            if (res.data.status) {\r\n                const clone = [...res.data.response];\r\n                setRows(\r\n                    clone.map((item) => ({\r\n                        ...item,\r\n                        // update_at: new Date(item.update_at).toLocaleString('vi-VI'),\r\n                        // start_date: new Date(item.start_date).toLocaleString('vi-VI'),\r\n                        // expire_date: new Date(item.expire_date).toLocaleString('vi-VI')\r\n                        update_at: formatDate(item.update_at),\r\n                        start_date: formatDate(item.start_date),\r\n                        expire_date: formatDate(item.expire_date)\r\n                    }))\r\n                );\r\n            }\r\n        } catch (error) {\r\n            console.error('Cannot get all ecoupons', error);\r\n        }\r\n    };\r\n\r\n    const handleUpdateRow = async (formData) => {\r\n        try {\r\n            const res = await axios.post(`http://${HOST_NAME}:3010/v1/api/tastie/admin/update-ecoupon`, formData);\r\n            if (res.data.status) {\r\n                await GetAllEcoupon(1, 50);\r\n            }\r\n        } catch (error) {\r\n            console.error('Cannot update ecoupon', error);\r\n        } finally {\r\n            setOpenModal(false);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        // socket.emit('admin', 'hello from admin');\r\n        GetAllEcoupon(1, 50);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        console.log(formData);\r\n    }, [formData]);\r\n\r\n    return (\r\n        <MainCard\r\n            title=\"Ecoupon List\"\r\n            // secondary={\r\n            //     <Button variant=\"contained\" onClick={() => addCoupon()}>\r\n            //         SOCKET\r\n            //     </Button>\r\n            // }\r\n        >\r\n            {/* <Card sx={{ overflow: 'hidden' }}>\r\n            <IFrameWrapper title=\"Tabler Icons\" width=\"100%\" src=\"https://tablericons.com/\" />\r\n        </Card> */}\r\n            <DataGrid\r\n                rows={rows}\r\n                columns={ecouponColumns}\r\n                pageSize={50}\r\n                checkboxSelection\r\n                disableSelectionOnClick\r\n                getRowId={(row) => row.ecoupon_id}\r\n                sx={{ width: '100%', height: '70vh' }}\r\n                // onPageChange={(page) => alert(page)}\r\n                onCellEditCommit={(event) => {\r\n                    const rowEdited = rows.find((row) => row.ecoupon_id === event.id);\r\n                    setFormData((prev) => ({\r\n                        ...prev,\r\n                        ...rowEdited,\r\n                        start_date: formatDate(rowEdited.start_date),\r\n                        expire_date: formatDate(rowEdited.expire_date),\r\n                        update_at: formatDate(rowEdited.update_at),\r\n                        [event.field]: event.value\r\n                    }));\r\n                    setOpenModal(true);\r\n                    // const formData = {\r\n                    //     ...rowEdited,\r\n                    //     [event.field]: event.value\r\n                    // };\r\n                    // console.log(formData);\r\n                    // handleUpdateRow(formData);\r\n                }}\r\n                onRowClick={(params, event, details) => {\r\n                    console.log(params);\r\n                    setOpenProviderList(true);\r\n                }}\r\n            />\r\n            <div>\r\n                <Dialog\r\n                    open={openModal}\r\n                    onClose={() => setOpenModal(false)}\r\n                    aria-labelledby=\"alert-dialog-title\"\r\n                    aria-describedby=\"alert-dialog-description\"\r\n                >\r\n                    <DialogTitle id=\"alert-dialog-title\">Are you sure to apply the changes ?</DialogTitle>\r\n                    <DialogContent>\r\n                        <DialogContentText id=\"alert-dialog-description\">\r\n                            This action will change the original record. Would you like to apply change ?\r\n                        </DialogContentText>\r\n                    </DialogContent>\r\n                    <DialogActions>\r\n                        <Button onClick={() => setOpenModal(false)}>Cancel</Button>\r\n                        <Button onClick={() => handleUpdateRow(formData)} autoFocus>\r\n                            Apply\r\n                        </Button>\r\n                    </DialogActions>\r\n                </Dialog>\r\n            </div>\r\n            <Modal\r\n                open={openProviderList}\r\n                onClose={handleClose}\r\n                aria-labelledby=\"modal-modal-title\"\r\n                aria-describedby=\"modal-modal-description\"\r\n            >\r\n                <Box sx={style}>\r\n                    <Typography id=\"modal-modal-title\" variant=\"h6\" component=\"h2\">\r\n                        Text in a modal\r\n                    </Typography>\r\n                    <Typography id=\"modal-modal-description\" sx={{ mt: 2 }}>\r\n                        Lorem ipsum, dolor sit amet consectetur adipisicing elit. Beatae nesciunt cupiditate praesentium neque odit, dicta\r\n                        quas delectus assumenda alias ab numquam! Quisquam facere odio veniam quos, pariatur sint quia doloribus magni,\r\n                        aperiam repudiandae ad reiciendis a placeat totam quidem porro consequuntur voluptate, hic vitae neque fugit eius.\r\n                        Dolorum, quibusdam sed consectetur iusto, quae tenetur ipsa et molestiae saepe ipsam cum enim nesciunt eligendi,\r\n                        eveniet aut. Iure quasi numquam at saepe. Eos eveniet quas numquam molestias quos voluptates, provident nam cumque\r\n                        unde porro aliquam sint doloribus harum? Nesciunt quam nihil praesentium laborum, ad placeat inventore porro\r\n                        voluptate? Expedita cumque voluptatibus nobis? Earum in cupiditate ea soluta excepturi modi dolore necessitatibus\r\n                        sed voluptates tempore quaerat, a minima, beatae laudantium delectus accusantium voluptas aliquam eos corrupti?\r\n                        Molestias excepturi libero esse asperiores, totam voluptates hic ullam doloribus iusto voluptatem molestiae quo\r\n                        saepe maxime nam inventore amet alias iure animi! Ratione laudantium iusto cum voluptatibus quos a minus sapiente\r\n                        architecto voluptas ipsum? Officiis voluptatem dolores nesciunt quidem, illum maxime reprehenderit aliquid veritatis\r\n                        incidunt nobis aut! Unde commodi aperiam doloremque delectus, sapiente quisquam reprehenderit dolorem explicabo\r\n                        sequi qui ipsam nam earum dolores maxime eos? Veniam mollitia alias voluptate dolores dolorem, qui quibusdam rem\r\n                        aspernatur impedit vero, quae quidem sequi? Enim recusandae aliquam repudiandae tempora omnis incidunt doloremque\r\n                        perspiciatis voluptates autem iusto voluptas itaque consequatur quisquam eligendi iure, ut numquam minima possimus\r\n                        deserunt dolore? Quis, eius, omnis recusandae cumque numquam velit blanditiis deleniti earum optio quisquam quo hic,\r\n                        et exercitationem. Dolorem nemo aut molestiae porro corrupti, saepe sequi eaque fugit animi iste sunt odit ex. Ex\r\n                        hic illum officiis eaque quam accusantium quos beatae, voluptate aut dolores expedita recusandae ab eligendi\r\n                        doloremque, reiciendis ducimus amet, modi ad saepe ipsam! Quisquam unde nihil doloremque! Architecto aut molestiae\r\n                        repudiandae, tempore iste qui sequi itaque ea sit. Libero excepturi amet, fugiat laudantium quas quis at in\r\n                        consequatur corporis optio modi recusandae nihil ab exercitationem nostrum iusto alias dignissimos magnam, quam\r\n                        tenetur officia facilis quia, praesentium ducimus! Enim, natus? Vitae aliquid sapiente necessitatibus ullam cumque\r\n                        deleniti possimus ad optio pariatur, facere in ex deserunt quidem, rerum, ea quas. Earum dolorem ex ab reiciendis,\r\n                        officia culpa maiores, eveniet nemo sapiente fuga necessitatibus aliquam. Nobis adipisci voluptas necessitatibus\r\n                        corporis repudiandae ad sint. Obcaecati esse voluptatem cumque sit delectus hic quibusdam dolor eveniet nulla totam?\r\n                        Tenetur consectetur minima libero laborum quod ab, consequuntur rem magni nesciunt nisi tempore facere distinctio\r\n                        quis, voluptates esse. Ea veritatis labore ipsa sapiente sequi rem ipsam veniam minima dignissimos inventore quaerat\r\n                        recusandae consequatur, quam iure. Labore modi quod molestias mollitia quo nesciunt inventore iusto dolor nisi\r\n                        dolore ipsa, dicta in similique fugit odio at error, corrupti nulla pariatur ut distinctio eaque, voluptatum\r\n                        facilis? Qui facere expedita temporibus pariatur consequuntur numquam odio distinctio fugit, impedit tempora ullam\r\n                        ipsum, commodi repellat quis cupiditate omnis. Iure harum quibusdam non magnam perspiciatis error similique quaerat\r\n                        velit, esse, in quidem sit maxime quos eaque nobis repudiandae dignissimos nisi placeat sed voluptas adipisci.\r\n                        Quibusdam eveniet culpa itaque eum impedit error ullam amet eaque ipsam beatae!\r\n                    </Typography>\r\n                </Box>\r\n            </Modal>\r\n        </MainCard>\r\n    );\r\n};\r\n\r\nexport default EcouponList;\r\n"]},"metadata":{},"sourceType":"module"}